---
import { t, changeLanguage } from "i18next";
import { getCollection } from "astro:content";
import Layout from "$layouts/base.astro";
import PageIntro from "$components/page-intro.svelte";
import Card from "$components/card.svelte";
import { tools } from "$data/tools";

changeLanguage("en");

// TODO: Set to i18next language and fallback to English
const currentLanguage = "en";
const guidesEntries = await getCollection("guides", ({ id }) => {
	return id.startsWith(`${currentLanguage}/`);
});
---

<Layout title={t("resources.title")} description={t("resources.description")}>
	<PageIntro
		heading={t("resources.title")}
		subheading={t("resources.description")}
	>
		<a
			href="https://discord.gg/r6wf35KVJW"
			class="animate-enter inline-flex h-12 items-center rounded-full bg-muted/10 px-6 font-medium transition hover:bg-muted/20 focus:outline-none focus:ring"
			style="--stagger: 2">{t("resources.help_link")}&nbsp;&nearr;</a
		>
	</PageIntro>

	<div class="h-20"></div>

	<section class="animate-enter" style="--stagger: 2">
		<h2 class="text-lg font-semibold tracking-tight">Guides</h2>

		<div class="h-6"></div>

		<ul class="grid grid-cols-2 gap-6 md:grid-cols-3">
			{
				guidesEntries
					.sort((a, b) => b.data.priority - a.data.priority)
					.map((guide) => (
						<li>
							<Card
								href={`/resources/${guide.slug.substring(3)}`}
								linkText={t("shared.read_more")}
							>
								<p class="font-semibold">{guide.data.title}</p>

								<div class="h-1.5" />

								<p>{guide.data.description}</p>
							</Card>
						</li>
					))
			}
		</ul>

		<div class="h-20"></div>

		<h2 class="text-lg font-bold tracking-tight">Tools</h2>

		<div class="h-6"></div>

		<ul class="grid grid-cols-2 gap-6 md:grid-cols-3">
			{
				tools.map(({ name, description, href }) => (
					<li>
						<Card href={href} linkText="Repository">
							<p class="font-bold">{name}</p>

							<div class="h-1.5" />

							<p>{description}</p>
						</Card>
					</li>
				))
			}
		</ul>
	</section>
</Layout>
